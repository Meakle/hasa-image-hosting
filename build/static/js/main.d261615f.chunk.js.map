{"version":3,"sources":["components/Header.jsx","components/Footer.jsx","App.jsx","index.js","models/index.js","stores/user.js","stores/history.js","stores/image.js","stores/auth.js","stores/index.js"],"names":["Header","styled","header","StyleNavLink","NavLink","Login","div","StyleButton","Button","Index","observer","useStores","UserStore","AuthStore","history","useHistory","useEffect","pullUser","to","activeClassName","exact","currentUser","attributes","username","type","onClick","logout","push","Footer","footer","A","a","index","href","target","YuqueOutlined","GithubOutlined","Home","lazy","History","About","Register","Main","main","App","Fragment","fallback","tip","size","path","component","ReactDOM","render","document","getElementById","AV","init","appId","appKey","serverURL","Auth","password","user","User","setUsername","setPassword","Promise","resolve","reject","signUp","then","error","logIn","logOut","current","Uploader","add","file","filename","item","Object","avFile","File","console","log","set","save","serverFile","find","page","limit","query","Query","include","skip","descending","equalTo","results","catch","window","makeObservable","this","observable","action","newList","list","concat","isLoading","append","length","hasMore","message","finally","newFilename","newFile","isUploading","values","resetUser","HistoryStore","reset","ImageStore","context","createContext","stores","useContext"],"mappings":"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","file":"static/js/main.d261615f.chunk.js","sourcesContent":["import React, { useEffect } from 'react'\nimport { NavLink, useHistory } from 'react-router-dom'\nimport { observer } from 'mobx-react'\nimport styled from 'styled-components'\nimport {Button} from 'antd'\n\nimport { useStores } from '../stores'\n\nconst Header = styled.header`\n    display: flex;\n    align-items: center;\n    padding: 12px 100px;\n    background-color: #ffffff;\n    color: #262626;\n`;\n\nconst StyleNavLink = styled(NavLink)`\n    color: #262626;\n    padding-bottom: 10px;\n    margin-left: 40px;\n\n    &.active{\n        border-bottom: 2px solid #3f90f7;\n    }\n`;\n\nconst Login = styled.div`\n    margin-left: auto;\n`\n\nconst StyleButton = styled(Button)`\n    margin-left: 20px;\n    font-weight: bolder;\n    font-size: 14px;\n`\n\nconst Index = observer(() => {\n    const { UserStore, AuthStore } = useStores();\n    const history = useHistory();\n\n    const handleLogout = () => {\n        AuthStore.logout();\n    }\n\n    const handleLogin = () => {\n        history.push('/login');\n    }\n\n    const handleRegister = () => {\n        history.push('/register');\n    }\n\n    useEffect(()=>{\n        UserStore.pullUser();\n    },[])\n\n    return (\n        <Header>\n            <nav>\n                <StyleNavLink to = \"/\" activeClassName={\"active\"} exact>首页</StyleNavLink>\n                <StyleNavLink to = \"/history\">历史</StyleNavLink>\n                <StyleNavLink to = \"/about\">关于</StyleNavLink>\n            </nav>\n            <Login>\n                {\n                    UserStore.currentUser ? <>\n                        <span>{UserStore.currentUser.attributes.username}</span>\n                        <StyleButton type=\"primary\" onClick= {handleLogout}>注销</StyleButton>\n                    </> : <>\n                        <StyleButton type=\"primary\" onClick= {handleLogin}>登录</StyleButton>\n                        <StyleButton type=\"primary\" onClick= {handleRegister}>注册</StyleButton>\n                    </>\n                }\n            </Login>\n        </Header>\n    )\n})\n\n\nexport default Index;","import React from 'react'\nimport { YuqueOutlined, GithubOutlined } from '@ant-design/icons'\nimport styled from 'styled-components'\n\nconst Footer = styled.footer`\n    padding: 0px 100px;\n    text-align: center;\n    font-size: 15px;\n    margin-bottom: 20px;\n    color: #bbbbbb;\n`\n\nconst A = styled.a`\n    color: #bbbbbb;\n    margin: 15px;\n    :hover{\n        color: #40a9ff;\n    }\n`\n\nexport default function index() {\n    return (\n        <Footer>\n            <A href=\"https://www.yuque.com/meakle\" target=\"_blank\"><YuqueOutlined /></A>\n            <A href=\"http://meakle.com/\" target=\"_blank\">@&nbsp;方阿森</A>\n            <A href=\"https://github.com/meakle\" target=\"_blank\"><GithubOutlined /></A>\n        </Footer>\n    )\n}","import React, { Suspense, lazy } from 'react'\nimport { Switch, Route } from 'react-router-dom'\nimport { Spin } from 'antd';\nimport styled from 'styled-components'\n\nimport Header from './components/Header'\nimport Footer from './components/Footer'\nimport './App.css'\n\nconst Home = lazy(() => import('./pages/Home'));\nconst History = lazy(() => import('./pages/History'));\nconst About = lazy(() => import('./pages/About'));\nconst Login = lazy(() => import('./pages/Login'));\nconst Register = lazy(() => import('./pages/Register'));\n\nconst Main = styled.main`\n    text-align: center;\n    margin: 20px 35px;\n`\n\nexport default function App() {\n    return (\n        <React.Fragment>\n            <Header />\n            <Main>\n                <Suspense fallback={<Spin tip=\"加载中\" size=\"large\"/>} >\n                    <Switch>\n                        <Route path=\"/\" exact component={Home} />\n                        <Route path=\"/history\" component={History} />\n                        <Route path=\"/about\" component={About} />\n                        <Route path=\"/login\" component={Login} />\n                        <Route path=\"/register\" component={Register} />\n                    </Switch>\n                </Suspense>\n            </Main>\n            <Footer />\n        </React.Fragment>\n    )\n}","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App.jsx'\nimport { HashRouter as Router } from 'react-router-dom'\n\n\nReactDOM.render(\n    <>\n        <Router>\n            <App />\n        </Router>\n    </>,\n    document.getElementById('root')\n)","import AV, { Query, User } from 'leancloud-storage'\n\nAV.init({\n    appId: \"E3vYhzO0pDzgBhmIYQdfQfEm-gzGzoHsz\",\n    appKey: \"YWD9Jpx17zt4zAYYOOIjRHQl\",\n    serverURL: \"https://e3vyhzo0.lc-cn-n1-shared.com\"\n});\n\n\nconst Auth = {\n\n    register(username, password) {\n        let user = new User();\n        user.setUsername(username);\n        user.setPassword(password);\n        return new Promise((resolve, reject) => {\n            user.signUp().then(User => resolve(User), error => reject(error))\n        });\n    },\n\n    login(username, password) {\n        return new Promise((resolve, reject) => {\n            User.logIn(username, password).then(User => resolve(User), error => reject(error))\n        });\n    },\n\n    logout() {\n        User.logOut();\n    },\n\n    getCurrentUser() {\n        return User.current();\n    }\n}\n\n\nconst Uploader = {\n\n    add(file, filename) {\n        // 声明并且实例化一个对象, 这里的对象将会是image表(类)中的一条数据\n        const item = new AV.Object('Image');\n        // 声明并且实例化一个对象, 用这个对象来储存文件\n        const avFile = new AV.File(filename, file);\n\n        console.log(AV.User.current());\n\n        // 给image表中的item这一项中的属性添加上他的值\n        item.set('filename', filename)\n        item.set('owner', AV.User.current());\n        item.set('url', avFile);\n\n\n        return new Promise((resolve, reject) => {\n            item.save().then((serverFile) => {\n                resolve(serverFile)\n            }, (error) => {\n                console.log('保存失败', error);\n                reject(error);\n            })\n        })\n    },\n\n    // find(page = 0, limit = 10){\n    //     const query = new Query('Image');\n    //     query.include('owner');\n    //     query.limit(limit);\n    //     query.skip(page*limit);\n    //     query.descending('createdAt');\n    //     query.equalTo('owner', User.current());\n    //     return new Promise((resolve, reject) => {\n    //         query.find()\n    //             .then(results => resolve(results))\n    //             .catch(error => reject(error));\n    //     })\n    // }\n\n    find({ page = 0, limit = 10 }) {\n        const query = new AV.Query('Image');\n        query.include('owner');\n        query.limit(limit);\n        query.skip(page * limit);\n        query.descending('createdAt');\n        query.equalTo('owner', AV.User.current());\n        return new Promise((resolve, reject) => {\n            query.find()\n                .then(results => resolve(results))\n                .catch(error => reject(error))\n        });\n    }\n}\n\nwindow.Uploader = Uploader;\n\nexport { Auth, Uploader };","import { observable ,action, makeObservable} from 'mobx'\nimport {Auth} from '../models'\n\nclass UserStore {\n\n    constructor() {\n        makeObservable(this);\n    }\n    \n    @observable currentUser = null;\n\n    @action pullUser(){\n        this.currentUser = Auth.getCurrentUser();\n    }\n\n    @action resetUser(){\n        this.currentUser = null;\n    }\n}\n\nexport default new UserStore()","import { observable ,action, makeObservable } from 'mobx'\nimport {Uploader } from '../models'\nimport {message} from 'antd'\n\nclass HistoryStore {\n\n    constructor() {\n        makeObservable(this);\n    }\n\n    @observable list=[];\n    @observable isLoading = false;\n    @observable hasMore = true;\n    @observable page = 0;\n    limit = 10;\n\n    @action append(newList){\n        this.list = this.list.concat(newList);\n    }\n\n    @action find(){\n        this.isLoading = true;\n        Uploader.find({page: this.page, limit: this.limit})\n            .then((newList) => {\n                this.append(newList);\n                this.page++;\n                if(newList.length < this.limit){\n                    this.hasMore = false;\n                }\n            })\n            .catch((error) => {\n                message.error('获取历史错误')\n                console.log(error);\n            })\n            .finally(() => {\n                this.isLoading = false;\n            });\n    }\n\n    @action reset() {\n        this.list=[];\n        this.isLoading = false;\n        this.hasMore = true;\n        this.page = 0;\n    }\n\n}\n\nexport default new HistoryStore();\n","import { observable ,action, makeObservable } from 'mobx'\nimport { Uploader } from '../models'\nimport { message } from 'antd'\n\nclass ImageStore {\n\n    constructor() {\n        makeObservable(this);\n    }\n    \n    @observable filename = '';\n    @observable file = null;\n    @observable isUploading = false;\n    @observable serverFile = null;\n\n    @action setFilename(newFilename) {\n        this.filename = newFilename;\n    };\n\n    @action setFile(newFile) {\n        this.file = newFile\n    };\n\n    @action upload(){\n        this.isUploading = true;\n        this.serverFile = null;\n        return new Promise((resolve, reject) => {\n            Uploader.add(this.file, this.filename)\n            .then((serverFile) => {\n                this.serverFile = serverFile;\n                resolve(serverFile);\n            })\n            .catch((error) => {\n                message.error('上传时发生错误');\n                reject(error);\n            })\n            .finally(() => {\n                this.isUploading = false;\n            })\n        })\n    }\n\n    @action reset(){\n        this.filename = '';\n        this.file = null;\n        this.serverFile = null;\n    }\n}\n\nexport default new ImageStore()","import { observable, action, makeObservable } from \"mobx\";\nimport { message } from 'antd'\nimport UserStore from './user'\nimport HistoryStore from './history'\nimport ImageStore from './image'\nimport { Auth } from '../models'\n\n\nclass AuthStore {\n\n    constructor() {\n        makeObservable(this);\n    }\n\n    // 用户信息?\n    @observable values = {\n        username: '',\n        password: ''\n    }\n    @action setUsername(username) {\n        this.values.username = username;\n    }\n    @action setPassword(password) {\n        this.values.password = password;\n    }\n    // 登录操作\n    @action login() {\n        return new Promise((resolve, reject) => {\n            Auth.login(this.values.username, this.values.password)\n                .then(user => {\n                    UserStore.pullUser();\n                    resolve(user);\n                }).catch(error => {\n                    UserStore.resetUser();\n                    message.error('账号或密码错误, 请尝试重新登录');\n                    reject(error);\n                })\n        })\n    }\n    // 注册操作\n    @action register() {\n        return new Promise((resolve, reject) => {\n            Auth.register(this.values.username, this.values.password)\n                .then(user => {\n                    // UserStore.pullUser();\n                    resolve(user);\n                }).catch(error => {\n                    UserStore.resetUser();\n                    message.error('该用户名已存在, 注册失败');\n                    reject(error);\n                })\n        })\n    }\n    // 注销操作\n    @action logout() {\n        Auth.logout();\n        HistoryStore.reset();\n        ImageStore.reset();\n        UserStore.resetUser();\n    }\n}\n\n\nexport default new AuthStore();","import { createContext, useContext} from 'react';\nimport AuthStore from './auth'\nimport UserStore from './user'\nimport ImageStore from './image'\nimport HistoryStore from './history'\n\nconst context = createContext({\n    AuthStore,\n    UserStore,\n    ImageStore,\n    HistoryStore\n});\n\nwindow.stores = {\n    AuthStore,\n    UserStore,\n    ImageStore,\n    HistoryStore\n};\n\nexport const useStores = () => useContext(context);"],"sourceRoot":""}